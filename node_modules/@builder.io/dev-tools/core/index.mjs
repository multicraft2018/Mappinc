var Sn=Object.create;var st=Object.defineProperty;var hn=Object.getOwnPropertyDescriptor;var Cn=Object.getOwnPropertyNames;var wn=Object.getPrototypeOf,yn=Object.prototype.hasOwnProperty;var V=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Dn=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Cn(t))!yn.call(e,o)&&o!==r&&st(e,o,{get:()=>t[o],enumerable:!(n=hn(t,o))||n.enumerable});return e};var vn=(e,t,r)=>(r=e!=null?Sn(wn(e)):{},Dn(t||!e||!e.__esModule?st(r,"default",{value:e,enumerable:!0}):r,e));var Me=V(be=>{"use strict";Object.defineProperty(be,"__esModule",{value:!0});function Mt(e){return Object.prototype.toString.call(e)}be.getType=Mt;function Pr(e){throw new TypeError("unsupported data type: "+Mt(e))}be.throwUnknownDataType=Pr});var Ge=V(_=>{"use strict";Object.defineProperty(_,"__esModule",{value:!0});var j="";for(let e=0;e<10;e++){let t=String.fromCharCode(48+e);j+=t}for(let e=0;e<26;e++){let t=String.fromCharCode(65+e);j+=t}for(let e=0;e<26;e++){let t=String.fromCharCode(97+e);j+=t}var H=j.length,We={};for(let e=0;e<H;e++){let t=j[e];We[t]=e}function Ye(e){let t=0,r=1;for(let n=e.length-1;n>=0;n--){let o=e[n],i=We[o];i*=r,t+=i,r*=H}return t}_.s_to_int=Ye;function Jt(e){let t=BigInt(0),r=BigInt(1),n=BigInt(H);for(let o=e.length-1;o>=0;o--){let i=e[o],a=BigInt(We[i]);a*=r,t+=a,r*=n}return t}_.s_to_big_int=Jt;function He(e){if(e===0)return j[0];let t=[];for(;e!==0;){let r=e%H,n=j[r];t.push(n),e-=r,e/=H}return t.reverse().join("")}_.int_to_s=He;function Wt(e){let t=BigInt(0),r=BigInt(H);if(e===t)return j[0];let n=[];for(;e!==t;){let o=e%r,i=j[Number(o)];n.push(i),e-=o,e/=r}return n.reverse().join("")}_.big_int_to_s=Wt;function Ie(e){return e.split("").reverse().join("")}function Yt(e){if(e<0)return"-"+Yt(-e);let[t,r]=e.toString().split(".");if(!r)return He(e);let n;r&&([r,n]=r.split("e")),t=Te(t),r=Ie(r),r=Te(r);let o=t+"."+r;if(n){switch(o+=".",n[0]){case"+":n=n.slice(1);break;case"-":o+="-",n=n.slice(1);break}n=Ie(n),n=Te(n),o+=n}return o}_.num_to_s=Yt;function Te(e){let t=+e;return t.toString()===e?He(t):":"+Wt(BigInt(e))}_.int_str_to_s=Te;function Je(e){return e[0]===":"?Jt(e.substring(1)).toString():Ye(e).toString()}function Ht(e){if(e[0]==="-")return-Ht(e.substr(1));let[t,r,n]=e.split(".");if(!r)return Ye(t);t=Je(t),r=Je(r),r=Ie(r);let o=t+"."+r;if(n){o+="e";let i=!1;n[0]==="-"&&(i=!0,n=n.slice(1)),n=Je(n),n=Ie(n),o+=i?-n:+n}return+o}_.s_to_num=Ht});var Ze=V(B=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});var Xe=Ge();function Nr(e){return"n|"+Xe.num_to_s(e)}B.encodeNum=Nr;function kr(e){return e=e.replace("n|",""),Xe.s_to_num(e)}B.decodeNum=kr;function Fr(e){return typeof e=="number"?e:Xe.s_to_int(e)}B.decodeKey=Fr;function Ar(e){return e?"b|T":"b|F"}B.encodeBool=Ar;function Lr(e){switch(e){case"b|T":return!0;case"b|F":return!1}return!!e}B.decodeBool=Lr;function Rr(e){switch(e[0]+e[1]){case"b|":case"o|":case"n|":case"a|":case"s|":e="s|"+e}return e}B.encodeStr=Rr;function Or(e){return e[0]+e[1]==="s|"?e.substr(2):e}B.decodeStr=Or});var Gt=V(et=>{"use strict";Object.defineProperty(et,"__esModule",{value:!0});et.config={sort_key:!1}});var nt=V(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});var jr=Gt(),_r=Me(),tt=Ze(),Br=Ge();function Vr(e){return e.store.toArray()}J.memToValues=Vr;function Xt(){let e=[];return{forEach(t){for(let r=0;r<e.length;r++)if(t(e[r])==="break")return},add(t){e.push(t)},toArray(){return e}}}J.makeInMemoryStore=Xt;function Zt(){let e=Object.create(null),t=Object.create(null);return{getValue(r){return e[r]},getSchema(r){return t[r]},forEachValue(r){for(let[n,o]of Object.entries(e))if(r(n,o)==="break")return},forEachSchema(r){for(let[n,o]of Object.entries(t))if(r(n,o)==="break")return},setValue(r,n){e[r]=n},setSchema(r,n){t[r]=n},hasValue(r){return r in e},hasSchema(r){return r in t}}}J.makeInMemoryCache=Zt;function zr(){return{store:Xt(),cache:Zt(),keyCount:0}}J.makeInMemoryMemory=zr;function M(e,t){if(e.cache.hasValue(t))return e.cache.getValue(t);let r=e.keyCount++,n=Br.num_to_s(r);return e.store.add(t),e.cache.setValue(t,n),n}function $r(e,t){jr.config.sort_key&&t.sort();let r=t.join(",");if(e.cache.hasSchema(r))return e.cache.getSchema(r);let n=ae(e,t,void 0);return e.cache.setSchema(r,n),n}function ae(e,t,r){if(t===null)return"";switch(typeof t){case"undefined":if(Array.isArray(r))return ae(e,null,r);break;case"object":if(t===null)return M(e,null);if(Array.isArray(t)){let n="a";for(let o=0;o<t.length;o++){let i=t[o],a=i===null?"_":ae(e,i,t);n+="|"+a}return n==="a"&&(n="a|"),M(e,n)}else{let n=Object.keys(t);if(n.length===0)return M(e,"o|");let o="o",i=$r(e,n);o+="|"+i;for(let a of n){let s=t[a],c=ae(e,s,t);o+="|"+c}return M(e,o)}case"boolean":return M(e,tt.encodeBool(t));case"number":return M(e,tt.encodeNum(t));case"string":return M(e,tt.encodeStr(t))}return _r.throwUnknownDataType(t)}J.addValue=ae});var ot=V(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});var Kr=Me(),Pe=Ze(),rt=nt();function Ur(e){let t=rt.makeInMemoryMemory(),r=rt.addValue(t,e,void 0);return[rt.memToValues(t),r]}le.compress=Ur;function Qr(e,t){if(t==="o|")return{};let r={},n=t.split("|"),o=n[1],i=se(e,o),a=n.length;a-2===1&&!Array.isArray(i)&&(i=[i]);for(let s=2;s<a;s++){let c=i[s-2],f=n[s];f=se(e,f),r[c]=f}return r}function qr(e,t){if(t==="a|")return[];let r=t.split("|"),n=r.length-1,o=new Array(n);for(let i=0;i<n;i++){let a=r[i+1];a=se(e,a),o[i]=a}return o}function se(e,t){if(t===""||t==="_")return null;let r=Pe.decodeKey(t),n=e[r];if(n===null)return n;switch(typeof n){case"undefined":return n;case"number":return n;case"string":switch(n[0]+n[1]){case"b|":return Pe.decodeBool(n);case"o|":return Qr(e,n);case"n|":return Pe.decodeNum(n);case"a|":return qr(e,n);default:return Pe.decodeStr(n)}}return Kr.throwUnknownDataType(n)}le.decode=se;function Mr(e){let[t,r]=e;return se(t,r)}le.decompress=Mr});var tn=V(Ne=>{"use strict";Object.defineProperty(Ne,"__esModule",{value:!0});function Jr(e){for(let t in e)e[t]===void 0&&delete e[t]}Ne.trimUndefined=Jr;function Wr(e){en(e,new Set)}Ne.trimUndefinedRecursively=Wr;function en(e,t){t.add(e);for(let r in e)if(e[r]===void 0)delete e[r];else{let n=e[r];n&&typeof n=="object"&&!t.has(n)&&en(n,t)}}});var on=V(K=>{"use strict";Object.defineProperty(K,"__esModule",{value:!0});var nn=ot();K.compress=nn.compress;K.decompress=nn.decompress;var Yr=ot();K.decode=Yr.decode;var Hr=nt();K.addValue=Hr.addValue;var rn=tn();K.trimUndefined=rn.trimUndefined;K.trimUndefinedRecursively=rn.trimUndefinedRecursively});async function lt(e,t){let r=e.resolve("/");for(let n=0;n<20;n++){let o=e.join(t,"package.json"),i=await e.readFile(o);if(i)return JSON.parse(i);if(t===r)break;t=e.dirname(t)}return null}async function ct(e,t){for(let r=0;r<20;r++){let n=e.dirname(t),o=e.join(n,"node_modules");if(await e.exists(o))return o;if(t===e.getRootDir())break;t=e.dirname(t)}return e.join(e.getRootDir(),"node_modules")}async function Fe(e,t,r){let n=await e.readdir(t);return n.includes(r)?e.join(t,r):(await Promise.all(n.map(async i=>{if(i.startsWith(".")||i==="node_modules")return;let a=e.join(t,i);if((await e.stat(a)).isDirectory()){let c=await Fe(e,a,r);if(c)return c}}))).find(i=>typeof i=="string")}async function G(e){let t=[],r=await lt(e,e.getRootDir());if(r){let n=ut(r);t.push(...n)}return t}function ut(e){let t=[];if(e&&typeof e=="object"){let r=new Set(Object.keys({...e.dependencies,...e.devDependencies}));for(let n of En)r.has(n)&&(t.some(o=>o.name===n)||t.push({name:n}))}return t}var En=["@builder.io/qwik-city","@sveltejs/kit","astro","gatsby","next","nuxt","remix","@builder.io/qwik","angular","react","solid-js","svelte","vue"];function y(e,t=""){return e.ts.createSourceFile("module.tsx",typeof t=="string"?t:"",e.ts.ScriptTarget.Latest)}function Ae(e,t=""){let r=y(e,t?.trim());if(r.statements.length===0)throw new Error(`No statements found in code: ${t}`);return r.statements[0]}function E(e,t,r){if(t){let n=e.ts.createPrinter({newLine:e.ts.NewLineKind.LineFeed,removeComments:r});return e.ts.isSourceFile(t)?n.printFile(t).trim()+`
`:n.printNode(e.ts.EmitHint.Unspecified,t,e.ts.createSourceFile("module.tsx","",e.ts.ScriptTarget.Latest)).trim()+`
`}return""}function I(e,t,r,n="esm"){return Array.isArray(r.namedImports)&&r.namedImports.forEach(o=>{t=bn(e,t,o,r.importPath,!!r.isTypeOnly,n)}),typeof r.defaultImport=="string"&&(t=Tn(e,t,r.defaultImport,r.importPath,n)),t}function bn(e,t,r,n,o,i){return i==="cjs"?ft(e,t,null,r,n):pt(e,t,null,r,n,o)}function Tn(e,t,r,n,o){return o==="cjs"?ft(e,t,r,null,n):pt(e,t,r,null,n,!1)}function pt(e,t,r,n,o,i){let a=[...t.statements],s=0,c=!1,f=!1;for(let l=0;l<a.length;l++){let m=a[l];if(!e.ts.isImportDeclaration(m)||(s=l,!m.moduleSpecifier||!e.ts.isStringLiteral(m.moduleSpecifier))||m.moduleSpecifier.text!==o||i&&m.importClause?.isTypeOnly!==i)continue;let g=[],S=m.importClause?.namedBindings;if(S&&e.ts.isNamedImports(S)&&S.elements&&g.push(...S.elements),typeof n=="string"){if(g.some(h=>h.name.text===n))return t;g.push(e.ts.factory.createImportSpecifier(!1,void 0,e.ts.factory.createIdentifier(n))),g.sort((h,C)=>h.name.text.localeCompare(C.name.text)),c=!0}let d=m.importClause?m.importClause.name:void 0;if(typeof r=="string"){if(d&&d.text===r)return t;d=e.ts.factory.createIdentifier(r),f=!0}if(c||f)return a[l]=e.ts.factory.updateImportDeclaration(m,void 0,e.ts.factory.createImportClause(i,d,e.ts.factory.createNamedImports(g)),m.moduleSpecifier,void 0),e.ts.factory.updateSourceFile(t,a)}let x,p;typeof r=="string"&&(x=e.ts.factory.createIdentifier(r)),typeof n=="string"&&(p=e.ts.factory.createNamedImports([e.ts.factory.createImportSpecifier(!1,void 0,e.ts.factory.createIdentifier(n))]));let u=e.ts.factory.createImportDeclaration(void 0,e.ts.factory.createImportClause(i,x,p),e.ts.factory.createStringLiteral(o));return a.splice(s,0,u),e.ts.factory.updateSourceFile(t,a)}function ft(e,t,r,n,o){let i=[...t.statements],a=0;for(let s=0;s<i.length;s++){let c=i[s];if(e.ts.isVariableStatement(c))for(let f=0;f<c.declarationList.declarations.length;f++){let x=[...c.declarationList.declarations],p=x[f],u=p.initializer;if(!u||!e.ts.isCallExpression(u))continue;let l=u.expression;if(!e.ts.isIdentifier(l)||l.text!=="require"||u.arguments.length!==1)continue;let m=u.arguments[0];if(e.ts.isStringLiteral(m)&&(a=s,m.text===o)){if(e.ts.isIdentifier(p.name)&&typeof r=="string")return p.name.text===r?t:(x[f]=e.ts.factory.updateVariableDeclaration(p,e.ts.factory.createIdentifier(r),p.exclamationToken,p.type,p.initializer),i[s]=e.ts.factory.updateVariableStatement(c,c.modifiers,e.ts.factory.updateVariableDeclarationList(c.declarationList,x)),e.ts.factory.updateSourceFile(t,i));if(e.ts.isObjectBindingPattern(p.name)&&typeof n=="string"){let g=[...p.name.elements];return g.some(d=>!e.ts.isBindingElement(d)||!e.ts.isIdentifier(d.name)?!1:d.name.text===n)?t:(g.push(e.ts.factory.createBindingElement(void 0,void 0,n)),g.sort((d,h)=>!e.ts.isBindingElement(d)||!e.ts.isIdentifier(d.name)||!e.ts.isBindingElement(h)||!e.ts.isIdentifier(h.name)?0:d.name.text.localeCompare(h.name.text)),x[f]=e.ts.factory.updateVariableDeclaration(p,e.ts.factory.createObjectBindingPattern(g),p.exclamationToken,p.type,p.initializer),i[s]=e.ts.factory.updateVariableStatement(c,c.modifiers,e.ts.factory.updateVariableDeclarationList(c.declarationList,x)),e.ts.factory.updateSourceFile(t,i))}}}}if(typeof r=="string"){let s=e.ts.factory.createVariableStatement(void 0,e.ts.factory.createVariableDeclarationList([e.ts.factory.createVariableDeclaration(r,void 0,void 0,e.ts.factory.createCallExpression(e.ts.factory.createIdentifier("require"),void 0,[e.ts.factory.createStringLiteral(o)]))],e.ts.NodeFlags.Const));return i.splice(a,0,s),e.ts.factory.updateSourceFile(t,i)}if(typeof n=="string"){let s=e.ts.factory.createVariableStatement(void 0,e.ts.factory.createVariableDeclarationList([e.ts.factory.createVariableDeclaration(e.ts.factory.createObjectBindingPattern([e.ts.factory.createBindingElement(void 0,void 0,n)]),void 0,void 0,e.ts.factory.createCallExpression(e.ts.factory.createIdentifier("require"),void 0,[e.ts.factory.createStringLiteral(o)]))],e.ts.NodeFlags.Const));return i.splice(a,0,s),e.ts.factory.updateSourceFile(t,i)}return t}async function ce(e,t){let r=await e.readFile(t);return typeof r=="string"?mt(r):null}function mt(e){let t={},r=e.replace(/\r\n?/gm,`
`),n;for(;(n=In.exec(r))!=null;){let o=n[1],i=n[2]||"";i=i.trim();let a=i[0];i=i.replace(/^(['"`])([\s\S]*)\1$/gm,"$2"),a==='"'&&(i=i.replace(/\\n/g,`
`),i=i.replace(/\\r/g,"\r")),t[o]=i}return t}var In=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/gm;async function ue(e,t,r,n){let o="# https://www.builder.io/c/docs/using-your-api-key",i=await e.readFile(t);i?i.includes(r)?i.includes(n)?e.debug(`"${r}" with "${n}" already set in ${t}`):(e.debug(`Replace "${r}" in ${t}`),i=i.replace(new RegExp(`${r}=.*`),`${r}=${n}`),await e.writeFile(t,i)):(e.debug(`Append "${r}" to ${t}`),i+=`

${o}
${r}=${n}

`,await e.writeFile(t,i)):(e.debug(`Creating new .env file with "${r}" at ${t}`),i=[o,`${r}=${n}`,""].join(`
`),await e.writeFile(t,i))}async function dt(e){let r=(await pe(e)).envVars[U];return typeof r=="string"&&r.length>0&&r!=="YOUR_API_KEY"?{publicApiKey:r,file:e.envPath}:null}async function gt(e,t){let r=await pe(e),n={publicApiKey:t,file:r.envPath};return await ue(e,r.envPath,U,t),n}async function pe(e){let t=[".env",".env.local",".env.development",".env.development.local",".env.production"].map(n=>e.join(e.getRootDir(),n)),r=[];for(let n of t){let o=await ce(e,n);if(o&&(r.push(n),Object.keys(o).includes(U)))return{envPath:n,envVars:o}}return r.length>0?{envPath:r[0],envVars:{}}:{envPath:t[0],envVars:{}}}var U="NEXT_PUBLIC_BUILDER_API_KEY";function O(e,t,r){t=z(t),r=z(r),t=e.dirname(t);let n=e.basename(r,e.extname(r));r=e.dirname(r);let o;return n==="index"?o=e.relative(t,r):o=e.relative(t,e.join(r,n)),o=z(e.normalize(o)),o.startsWith(".")||(o="./"+o),o}function z(e){return e.startsWith("\\\\?\\")?e:e.replace(/\\/g,"/")}function X(e,t){let r=e.extname(t),n=e.basename(t,r);return xt(n==="index"?e.basename(e.dirname(t)):n)}function xt(e){return F(e).replace(/ /g,"")}function Q(e,t){let r=e.extname(t),n=z(e.basename(t,r)).split("/").pop();return F(n==="index"?e.basename(e.dirname(t)):n)}function v(e,t){let r=t,n=[];for(let o=0;o<3;o++){let i=e.basename(r);if(!i||i==="components")break;n.unshift(i),r=e.dirname(r)}return n.join("/")}function F(e){for(e=e.replace(/([A-Z])/g," $1").replace(/\./g," ").replace(/_/g," ").replace(/-/g," ").replace(/\s/g," ").trim();e.includes("  ");)e=e.replace(/  /g," ");return e.split(" ").map(t=>t.length>2?t[0].toUpperCase()+t.slice(1):t).join("").trim()}function W(e){return e.sort((t,r)=>t.name.toLocaleLowerCase().localeCompare(r.name.toLocaleLowerCase()))}async function A(e,t,r){if(typeof r!="string"||r==="")throw new Error(`getComponentId(), exportName must be a non-empty string, received: ${r}, ${t}`);return t=e.normalize(t),(await e.hash(t+"#"+r)).substring(0,8)}function fe(e){return typeof e=="number"}function Z(e){return typeof e=="boolean"}function P(e){return typeof e=="string"}function Le(e){return typeof e=="string"?/^[A-Z][A-Za-z0-9]*$/.test(e):!1}function b(e){return JSON.parse(JSON.stringify(e))}function te(e,t,r,n,o=!0){let i=t.properties.filter(s=>e.ts.isPropertyAssignment(s)),a=Pn(e,t,r);return a>-1?n==null&&o?e.ts.factory.updateObjectLiteralExpression(t,i.filter((s,c)=>c!==a)):(i[a]=e.ts.factory.updatePropertyAssignment(i[a],i[a].name,ee(e,n)),e.ts.factory.updateObjectLiteralExpression(t,i)):(n!=null&&i.push(e.ts.factory.createPropertyAssignment(r,ee(e,n))),e.ts.factory.updateObjectLiteralExpression(t,i))}function Pn(e,t,r){return t.properties.findIndex(n=>D(e,n)===r)}function me(e,t){switch(t.kind){case e.ts.SyntaxKind.ArrayLiteralExpression:return kn(e,t);case e.ts.SyntaxKind.ObjectLiteralExpression:return Nn(e,t);case e.ts.SyntaxKind.StringLiteral:return t.text;case e.ts.SyntaxKind.NumericLiteral:return Number(t.text);case e.ts.SyntaxKind.NoSubstitutionTemplateLiteral:return t.text;case e.ts.SyntaxKind.TrueKeyword:return!0;case e.ts.SyntaxKind.FalseKeyword:return!1;case e.ts.SyntaxKind.Identifier:switch(t.escapedText){case"undefined":return;case"null":return null;case"String":return String;case"Number":return Number;case"Boolean":return Boolean;case"NaN":return NaN}}}function Nn(e,t){let r={};if(t&&e.ts.isObjectLiteralExpression(t)){for(let n of t.properties)if(e.ts.isPropertyAssignment(n)){let o=D(e,n);o&&(r[o]=me(e,n.initializer))}}return r}function kn(e,t){return t&&e.ts.isArrayLiteralExpression(t)?t.elements.map(r=>me(e,r)):[]}function D(e,t){if(t&&e.ts.isPropertyAssignment(t)){let r=t.name;switch(r.kind){case e.ts.SyntaxKind.Identifier:return r.text;case e.ts.SyntaxKind.StringLiteral:case e.ts.SyntaxKind.NumericLiteral:return r.text;case e.ts.SyntaxKind.ComputedPropertyName:let n=r.expression;if(e.ts.isStringLiteral(n)||e.ts.isNumericLiteral(n))return r.expression.text}}}function ee(e,t){return Re(e,t,new WeakSet)}function Re(e,t,r){return t===void 0?e.ts.factory.createIdentifier("undefined"):t===null?e.ts.factory.createIdentifier("null"):typeof t=="string"?e.ts.factory.createStringLiteral(t):typeof t=="number"?isNaN(t)?e.ts.factory.createIdentifier("NaN"):e.ts.factory.createNumericLiteral(t):t===!0?e.ts.factory.createTrue():t===!1?e.ts.factory.createFalse():t===String?e.ts.factory.createIdentifier("String"):t===Number?e.ts.factory.createIdentifier("Number"):t===Boolean?e.ts.factory.createIdentifier("Boolean"):Array.isArray(t)?Fn(e,t,r):typeof t=="object"?An(e,t,r):e.ts.factory.createIdentifier(t)}function Fn(e,t,r){let n=t.map(o=>Re(e,o,r));return e.ts.factory.createArrayLiteralExpression(n,!0)}function An(e,t,r){if(r.has(t))return e.ts.factory.createIdentifier("undefined");r.add(t);let n=Object.keys(t).map(o=>e.ts.factory.createPropertyAssignment(o,Re(e,t[o],r)));return e.ts.factory.createObjectLiteralExpression(n,!0)}function de(e,t,r){let n=[],o=t.getTypeAtLocation(r),i;o.aliasTypeArguments&&o.aliasTypeArguments.length>0?i=o.aliasTypeArguments[0].getProperties():i=o.getProperties();for(let a of i){let s=Ln(e,t,a);s&&n.push(s)}return n}function Ln(e,t,r){let n=r.valueDeclaration;if(n&&e.ts.isPropertySignature(n)){let o=r.getName(),i=Rn(t,n),a={name:o,type:i,isRegistered:!1};return n.questionToken||(a.required=!0),a}return null}function Rn(e,t){if(t?.type){let r=e.getTypeFromTypeNode(t.type),n=e.typeToString(r);return Oe(n)}return"string"}function Oe(e){return typeof e=="string"&&(e=e.trim(),On.some(t=>t.value===e))?e:"string"}var On=[{value:"boolean",text:"boolean"},{value:"color",text:"color (provides a color in hex or rgb)"},{value:"date",text:"date (same format as the Date constructor)"},{value:"email",text:"email"},{value:"file",text:"file (uploads a file and provides a url)"},{value:"list",text:"list (collection of items)"},{value:"longText",text:"longText (multiline text editor)"},{value:"number",text:"number"},{value:"object",text:"object (set of specific names and values)"},{value:"richText",text:"richText (provides value as html)"},{value:"string",text:"string"}];function ge(e,t,r){for(let n of r.properties){if(!e.ts.isPropertyAssignment(n))continue;let o=D(e,n);if(o==="name"&&e.ts.isStringLiteral(n.initializer)){t.name=n.initializer.text;continue}if(o==="description"&&e.ts.isStringLiteral(n.initializer)){t.description=n.initializer.text;continue}if(o==="image"&&e.ts.isStringLiteral(n.initializer)){t.image=n.initializer.text;continue}if(o==="inputs"&&e.ts.isArrayLiteralExpression(n.initializer)){let i=jn(e,n.initializer);re(t,i);continue}}return t}function jn(e,t){let r=[];for(let n of t.elements)e.ts.isObjectLiteralExpression(n)&&r.push(_n(e,n));return r}function _n(e,t){let r=me(e,t);return r=Kn(r),r.isRegistered=!0,r}function ne(e,t,r){return t=te(e,t,"name",r.name,!1),t=te(e,t,"description",r.description),t=te(e,t,"image",r.image),t=Bn(e,t,r),Un(e,t)}function Bn(e,t,r){let n=null,o=r.inputs.filter(s=>s.isRegistered),i=t.properties.filter(s=>e.ts.isPropertyAssignment(s)&&e.ts.isIdentifier(s.name)),a=i.findIndex(s=>e.ts.isIdentifier(s.name)&&s.name.text==="inputs");if(a>-1){if(o.length===0)return te(e,t,"inputs",null);let s=i[a];e.ts.isPropertyAssignment(s)&&e.ts.isArrayLiteralExpression(s.initializer)&&(n=s.initializer)}return o.length===0?t:(n=Vn(e,n||e.ts.factory.createArrayLiteralExpression(),o),a>-1?i[a]=e.ts.factory.updatePropertyAssignment(i[a],i[a].name,n):i.push(e.ts.factory.createPropertyAssignment("inputs",n)),e.ts.factory.updateObjectLiteralExpression(t,i))}function Vn(e,t,r){let n=t.elements.filter(o=>{if(!e.ts.isObjectLiteralExpression(o))return!1;let i=o.properties.find(s=>D(e,s)==="name");if(!i)return!1;let a=i.initializer;return e.ts.isStringLiteral(a)?r.some(s=>s.name===a.text):!1});for(let o of r)n=zn(e,n,o);return n.sort((o,i)=>{let a=o.properties.find(u=>D(e,u)==="name"),s=i.properties.find(u=>D(e,u)==="name"),c=a?.initializer,f=s?.initializer,x=c&&e.ts.isStringLiteral(c)?c.text:"zz",p=f&&e.ts.isStringLiteral(f)?f.text:"zz";return x.toLowerCase().localeCompare(p.toLowerCase())}),e.ts.factory.updateArrayLiteralExpression(t,n)}function zn(e,t,r){let n=t.findIndex(o=>o.properties.some(i=>{let a=D(e,i);return e.ts.isPropertyAssignment(i)&&a==="name"&&e.ts.isStringLiteral(i.initializer)&&i.initializer.text===r.name}));if(n>-1)t[n]=St(e,t[n],r);else{let o=St(e,e.ts.factory.createObjectLiteralExpression([e.ts.factory.createPropertyAssignment("name",e.ts.factory.createStringLiteral(r.name))],!0),r);t.push(o)}return t}function St(e,t,r){let n=t.properties.filter(i=>e.ts.isPropertyAssignment(i)),o=Object.keys(r).filter(i=>i!=="isRegistered");for(let i of o)n=$n(e,n,r,i);return n=Qn(e,n.filter(i=>{let a=D(e,i);return o.includes(a)})),e.ts.factory.updateObjectLiteralExpression(t,n)}function $n(e,t,r,n){let o=t.findIndex(i=>e.ts.isIdentifier(i.name)&&i.name.text===n);return o>-1?t[o]=e.ts.factory.updatePropertyAssignment(t[o],t[o].name,ee(e,r[n])):t.push(e.ts.factory.createPropertyAssignment(n,ee(e,r[n]))),t}function re(e,t){for(let r of t){let n=e.inputs.findIndex(o=>o.name===r.name);n>-1?(r.isRegistered||!e.inputs[n].isRegistered)&&(e.inputs[n]=r):e.inputs.push(r)}}function Kn(e){let t={name:e.name.trim(),type:Oe(e.type)};return P(e.friendlyName)&&e.friendlyName.trim()!==e.name.trim()&&(t.friendlyName=e.friendlyName),(P(e.defaultValue)||fe(e.defaultValue)||Z(e.defaultValue))&&(t.defaultValue=e.defaultValue),P(e.helperText)&&(t.helperText=e.helperText),Z(e.required)&&(t.required=e.required),t}function Un(e,t){let r=[...t.properties].sort((n,o)=>{let i=D(e,n)||"zz",a=D(e,o)||"zz";if(i==="inputs")return 1;let s=ht.indexOf(i),c=ht.indexOf(a);return s>-1?c>-1&&s>c?1:-1:c>-1?s>-1&&c<s?-1:1:i.localeCompare(a)});return e.ts.factory.updateObjectLiteralExpression(t,r)}var ht=["component","name","description"];function Qn(e,t){return[...t].sort((n,o)=>{let i=D(e,n)||"zz",a=D(e,o)||"zz",s=Ct.indexOf(i),c=Ct.indexOf(a);return s>-1?c>-1&&s>c?1:-1:c>-1?s>-1&&c<s?-1:1:i.localeCompare(a)})}var Ct=["name","type"];function wt(e,t){let r=`Builder.registerComponent(
`,n=O(e,e.registryPath,t.filePath);t.exportName==="default"?r+=`  dynamic(() => import(${JSON.stringify(n)})),
`:r+=`  dynamic(async () => (await import(${JSON.stringify(n)})).${t.exportName}),
`,r+=`  {
    name: "${t.name}",
  }
`,r+=");";let o=Ae(e,r);return je(e,o,t)}function je(e,t,r){if(!e.ts.isExpressionStatement(t))return t;let n=t.expression;if(!e.ts.isCallExpression(n))return t;let o=[...n.arguments];if(o.length<2)return t;let i=o[1];return e.ts.isObjectLiteralExpression(i)?(o[1]=ne(e,i,r),e.ts.factory.updateExpressionStatement(t,e.ts.factory.updateCallExpression(n,n.expression,n.typeArguments,o))):t}function $(e,t,r="esm"){return r==="cjs"?Mn(e,t):qn(e,t)}function qn(e,t){let r=[];for(let n of t.statements){if(e.ts.isExportDeclaration(n)){if(n.exportClause&&e.ts.isNamedExports(n.exportClause)){for(let o of n.exportClause.elements)if(e.ts.isIdentifier(o.name)){let i=o.name.text;for(let a of t.statements)if(e.ts.isVariableStatement(a))for(let s of a.declarationList.declarations)e.ts.isIdentifier(s.name)&&s.name.text===i&&r.push({isDefaultExport:!1,statement:a,node:a});else e.ts.isFunctionDeclaration(a)&&a.name&&a.name.text===i&&r.push({isDefaultExport:!1,statement:a,node:a})}}continue}if(e.ts.isExportAssignment(n)){let o=n.flags===e.ts.NodeFlags.None,i=n.expression;if(e.ts.isIdentifier(i)){let a=i.text;for(let s of t.statements){if(e.ts.isVariableStatement(s))for(let c of s.declarationList.declarations)e.ts.isIdentifier(c.name)&&c.name.text===a&&r.push({isDefaultExport:o,statement:s,node:s});e.ts.isFunctionDeclaration(s)&&s.name?.text===a&&r.push({isDefaultExport:o,statement:s,node:s})}}else(e.ts.isArrowFunction(i)||e.ts.isCallExpression(i)||e.ts.isFunctionDeclaration(i)||e.ts.isObjectLiteralExpression(i))&&r.push({isDefaultExport:o,statement:n,node:i});continue}if((e.ts.isVariableStatement(n)||e.ts.isFunctionDeclaration(n))&&n.modifiers&&n.modifiers.some(o=>o.kind===e.ts.SyntaxKind.ExportKeyword)){r.push({isDefaultExport:n.modifiers.some(o=>o.kind===e.ts.SyntaxKind.DefaultKeyword),statement:n,node:n});continue}}return r}function Mn(e,t){let r=[];for(let n of t.statements)if(e.ts.isExpressionStatement(n)&&e.ts.isBinaryExpression(n.expression)&&e.ts.isPropertyAccessExpression(n.expression.left)){let o=n.expression.left,i=n.expression.right;if(!e.ts.isIdentifier(o.expression))continue;if(o.expression.text==="module"&&o.name.text==="exports"){if(e.ts.isIdentifier(i)){let a=i.text;for(let s of t.statements)if(e.ts.isVariableStatement(s))for(let c of s.declarationList.declarations)e.ts.isIdentifier(c.name)&&c.name.text===a&&r.push({isDefaultExport:!0,statement:s,node:s});else e.ts.isFunctionDeclaration(s)&&s.name&&s.name.text===a&&r.push({isDefaultExport:!0,statement:s,node:s})}else r.push({isDefaultExport:!0,statement:n,node:i});continue}}return r}function Jn(e,t,r){for(let n of t.statements)if(e.ts.isImportDeclaration(n)&&n.importClause){if(n.importClause.namedBindings&&e.ts.isNamedImports(n.importClause.namedBindings)){for(let o of n.importClause.namedBindings.elements)if(e.ts.isIdentifier(o.name)&&o.name.text===r&&e.ts.isStringLiteral(n.moduleSpecifier))return{importPath:n.moduleSpecifier.text,exportType:"named"}}if(n.importClause.name&&n.importClause.name.text===r&&e.ts.isStringLiteral(n.moduleSpecifier))return{importPath:n.moduleSpecifier.text,exportType:"default"}}return null}async function yt(e,t,r,n){let o=Jn(e,r,n);if(o){let i=await Ve(e,e.normalize(e.resolve(e.dirname(t),o.importPath)));return{displayFilePath:v(e,i),filePath:i,importPath:o.importPath,exportType:o.exportType}}return null}function Be(e,t,r){for(let n=0;n<t.statements.length;n++){let o=t.statements[n];if(e.ts.isVariableStatement(o)){for(let i of o.declarationList.declarations)if(e.ts.isIdentifier(i.name)&&i.name.text===r)return{statement:o,statementIndex:n}}}return null}function xe(e,t,r){let n=Be(e,t,r);if(n&&n.statement.declarationList.declarations.length>0){let o=n.statement.declarationList.declarations[0];if(o.initializer&&e.ts.isArrayLiteralExpression(o.initializer))return{statement:n.statement,statementIndex:n.statementIndex,variableDeclaration:o,arrayLiteralExp:o.initializer}}return null}function Se(e,t){if(t){if(Wn(e,t))return!0;let r=!1;if(t.forEachChild(n=>{Se(e,n)&&(r=!0)}),r)return!0}return!1}function Wn(e,t){return e.ts.isJsxElement(t)||e.ts.isJsxOpeningElement(t)||e.ts.isJsxOpeningFragment(t)||e.ts.isJsxSelfClosingElement(t)||e.ts.isJsxFragment(t)||e.ts.isJsxChild(t)}async function Ve(e,t){let r=e.extname(t).toLowerCase();if(r===""||!_e.includes(r)){for(let n of _e){let o=t+n;if(await e.exists(o))return o}for(let n of _e){let o=e.join(t,"index"+n);if(await e.exists(o))return o}}return t}var _e=[".tsx",".jsx",".ts",".js"];async function Dt(e,t){let r=e.extname(t).toLowerCase();if(r===".tsx"||r===".jsx"||r===".ts"||r===".js"){let n=await e.readFile(t);if(n)return Yn(e,t,n)}return null}function Yn(e,t,r){let n=y(e,r);return ze(e,t,n)}async function ze(e,t,r){let n=[];for(let i of r.statements)if(e.ts.isExpressionStatement(i)&&e.ts.isStringLiteral(i.expression)&&i.expression.text==="use server")return n;let o=$(e,r);return t=e.normalize(t),await Promise.all(o.map(async i=>{let a=await Hn(e,t,i);n.push(...a)})),n}async function Hn(e,t,r){let n=[];if(e.ts.isVariableStatement(r.node)){for(let o of r.node.declarationList.declarations){if(!e.ts.isIdentifier(o.name)||!Le(o.name.text))continue;let i=he(e,o.initializer);if(i){let a=i.fnName||o.name.text,s=r.isDefaultExport?"default":a,c=r.isDefaultExport?"default":"named";n.push({cmpInfo:{id:await A(e,t,s),displayFilePath:v(e,t),name:F(a),inputs:[],exportName:s,exportType:c,importName:a,filePath:t},node:i})}}return n}if(e.ts.isArrowFunction(r.node)){let o=he(e,r.node);if(o){let i=Q(e,t),a=r.isDefaultExport?"default":i,s=r.isDefaultExport?"default":"named";n.push({cmpInfo:{id:await A(e,t,a),displayFilePath:v(e,t),name:i,inputs:[],exportName:a,exportType:s,importName:X(e,t),filePath:t},node:o})}return n}if(e.ts.isFunctionExpression(r.node)||e.ts.isFunctionDeclaration(r.node)){let o=r.node.name?.text;if(o&&!Le(o))return n;let i=he(e,r.node);if(i){let a=i.fnName||Q(e,t),s=r.isDefaultExport||!i.fnName?"default":i.fnName,c=r.isDefaultExport?"default":"named";n.push({cmpInfo:{id:await A(e,t,s),displayFilePath:v(e,t),name:a,inputs:[],exportName:s,exportType:c,importName:X(e,t),filePath:t},node:i})}return n}return n}function he(e,t){if(!t)return null;if(e.ts.isArrowFunction(t))return Se(e,t.body)?{fnName:"",fnParams:t.parameters}:null;if(e.ts.isFunctionExpression(t)||e.ts.isFunctionDeclaration(t))return Se(e,t.body)?{fnName:t.name?.text||"",fnParams:t.parameters}:null;if(e.ts.isCallExpression(t)){let r=t.expression;if(!e.ts.isPropertyAccessExpression(r))return null;let n=t.arguments;if(n.length===0)return null;let o=r.expression;if(!e.ts.isIdentifier(o)||o.text!=="React")return null;let i=r.name;return!e.ts.isIdentifier(i)||i.text!=="forwardRef"?null:he(e,n[0])}return null}async function vt(e){let t=[],r=async n=>{let o=await e.readdir(n);await Promise.all(o.map(async i=>{if(i.startsWith(".")||i==="node_modules"||e.appDir&&Gn.has(i))return;let a=e.join(n,i);if(a===e.nextConfigPath||a===e.registryPath)return;let s=await Dt(e,a);if(s){t.push(...s);return}if(i==="pages"&&e.pagesDir&&a===e.pagesDir)return;(await e.stat(a)).isDirectory()&&await r(a)}))};return await r(e.getRootDir()),t}var Gn=new Set(["default.tsx","default.ts","default.jsx","default.js","error.tsx","error.ts","error.jsx","error.js","layout.tsx","layout.ts","layout.jsx","layout.js","loading.tsx","loading.ts","loading.jsx","loading.js","not-found.tsx","not-found.ts","not-found.jsx","not-found.js","page.tsx","page.ts","page.jsx","page.js","route.tsx","route.ts","route.jsx","route.js","template.tsx","template.ts","template.jsx","template.js"]);function Ce(e,t){let r=[],n=[],o=[],i=[];for(let a of t.statements){if(e.ts.isImportDeclaration(a)){if(e.ts.isStringLiteral(a.moduleSpecifier)){let c=a.moduleSpecifier.text;if(!c.startsWith(".")&&!c.startsWith("/")){r.push(a);continue}}let s=a.importClause;if(s){if(s.namedBindings){n.push(a);continue}if(s.name){n.push(a);continue}}o.push(a);continue}i.push(a)}return e.ts.factory.updateSourceFile(t,[...$e(e,r),...$e(e,n),...$e(e,o),...i])}function Y(e){let t=e.split(`
`).map(n=>n.trimEnd());e="";let r=!1;for(let n=t.length-1;n>=0;n--){let o=t[n];!r&&o.startsWith("import ")&&(r=!0,o=o+`
`),/^builder.init(.*)$/.test(o)&&(o=o+`
`),t[n-1]&&!t[n-1].includes("*/")&&(o.trim().startsWith("Builder.registerComponent")&&(o=`
`+o),o.trim().startsWith("/**")&&(o=`
`+o),o.trim().startsWith("module.exports")&&(o=`
`+o),o.trim().startsWith("export ")&&(o=`
`+o)),e=o+`
`+e}return e.trim()+`
`}function $e(e,t){return t.sort((r,n)=>{let o=Et(e,r),i=Et(e,n);return o.toLocaleLowerCase().localeCompare(i.toLocaleLowerCase())})}function Et(e,t){let r=t.importClause;if(r){let n=r.namedBindings;if(n&&e.ts.isNamedImports(n)&&n.elements.length>0)return n.elements[0].name.text;if(r.name)return r.name.text}return t.moduleSpecifier&&e.ts.isStringLiteral(t.moduleSpecifier)?t.moduleSpecifier.text:""}function bt(e){return typeof e=="string"&&!e.includes("'use client'")&&!e.includes(`"use client"'`)&&(e=`"use client"
${e}`),e}function Tt(e,t){let r=t.statements.filter(n=>!(e.ts.isExpressionStatement(n)&&e.ts.isStringLiteral(n.expression)&&e.ts.isStringLiteral(n.expression)&&n.expression.text==="use client"));return e.ts.factory.updateSourceFile(t,r)}async function Pt(e){let t=await e.readFile(e.registryPath);return t?Xn(e,t):{components:[],sourceFile:y(e,"")}}async function Xn(e,t){let r=y(e,t);return Zn(e,r)}async function Zn(e,t){let r=[];for(let n=0;n<t.statements.length;n++){let o=t.statements[n];if(!e.ts.isExpressionStatement(o))continue;let i=o.expression;if(!e.ts.isCallExpression(i))continue;let a=i.expression;if(!e.ts.isPropertyAccessExpression(a))continue;let s=a.expression;if(!e.ts.isIdentifier(s)||s.text!=="Builder"||a.name.text!=="registerComponent")continue;let f=i.arguments;if(f.length<2)continue;let x=f[0];if(!e.ts.isCallExpression(x))continue;let p=f[1];if(!e.ts.isObjectLiteralExpression(p))continue;let u=await er(e,n,x,p);u&&r.push(u)}return{sourceFile:t,components:W(r)}}async function er(e,t,r,n){let o={id:"",name:"",displayFilePath:"",exportName:"",importName:"",filePath:"",inputs:[],nodeIndex:t},i=r.arguments;if(i.length===0)return null;let a=i[0];if(!e.ts.isArrowFunction(a))return null;let s=a.body;if(e.ts.isCallExpression(s)){if(s.expression.kind!==e.ts.SyntaxKind.ImportKeyword||s.arguments.length!==1)return null;let f=s.arguments[0];if(!e.ts.isStringLiteral(f))return null;let x=f.text;o.filePath=await It(e,x),o.name=Q(e,o.filePath),o.importName="default",o.exportName="default",o.exportType="default"}else if(e.ts.isPropertyAccessExpression(s)){let c=s.expression;if(!e.ts.isParenthesizedExpression(c))return null;let f=c.expression;if(!e.ts.isAwaitExpression(f))return null;let x=f.expression;if(!e.ts.isCallExpression(x)||x.expression.kind!==e.ts.SyntaxKind.ImportKeyword||x.arguments.length!==1)return null;let u=x.arguments[0];if(!e.ts.isStringLiteral(u)||!e.ts.isIdentifier(s.name))return null;let l=u.text;o.filePath=await It(e,l),o.name=F(s.name.text),o.importName=s.name.text,o.exportName=s.name.text,o.exportType="named"}else return null;return o=ge(e,o,n),o.displayFilePath=v(e,o.filePath),o.filePath&&o.exportName&&(o.id=await A(e,o.filePath,o.exportName)),o}function It(e,t){return Ve(e,e.normalize(e.resolve(e.dirname(e.registryPath),t)))}async function tr(e,t){let r=await ct(e,t),n=e.join(r,"typescript","lib"),o=new Map,i={fileExists:a=>{if(a=e.normalize(a),a.includes("node_modules")){let s=oe.get(a);return s||(e.existsSync(a)?s={exists:!0,content:e.readFileSync(a)}:s={exists:!1},oe.set(a,s)),s.exists}return o.has(a)||o.set(a,e.existsSync(a)),o.get(a)},getCanonicalFileName:a=>e.normalize(a),getCurrentDirectory:()=>e.cwd(),getDefaultLibFileName:()=>e.join(n,"lib.d.ts"),getDefaultLibLocation:()=>n,getNewLine:()=>`
`,getSourceFile:a=>{if(a=e.normalize(a),a.includes("node_modules")){let c=oe.get(a);if(c)return y(e,c.content)}let s=e.readFileSync(a);if(s==null){let c=e.basename(a),f=e.extname(c).toLowerCase();if(a.startsWith(n)&&f===".ts"&&(s=kt.get(c),s==null&&typeof self<"u"&&typeof fetch=="function"))throw new ye(c)}return a.includes("node_modules")&&(s?oe.set(a,{exists:!0,content:s}):oe.set(a,{exists:!1})),y(e,s)},readFile:a=>{let s=e.readFileSync(a);return typeof s=="string"?s:void 0},useCaseSensitiveFileNames:()=>!1,writeFile:()=>{}};for(;;)try{return nr(e,i,t)}catch(a){if(a instanceof ye){await rr(e,a.libName);continue}return console.error(a),null}}function nr(e,t,r){let n={rootNames:[r],options:{},host:t},o=e.ts.findConfigFile(e.dirname(r),i=>e.existsSync(i));if(o){let i=Nt.get(o);if(!i){let a=e.ts.readConfigFile(o,s=>{let c=e.readFileSync(s);return typeof c=="string"?c:void 0});a.error?console.error("error reading tsconfig for createTsProgram"):(i=e.ts.parseJsonConfigFileContent(a.config,e.ts.sys||{useCaseSensitiveFileNames:!1,readDirectory:(c,f)=>e.readdirSync(c),fileExists:c=>e.existsSync(c),readFile:c=>e.readFileSync(c)||void 0},e.dirname(o),void 0,o).options,Nt.set(o,i))}i&&(n.options=b(i))}return n.options.moduleResolution=e.ts.ModuleResolutionKind.Node16,n.options.noEmit=!0,n.options.isolatedModules=!1,n.options.strict=!1,n.options.jsx=e.ts.JsxEmit.Preserve,n.options.allowJs=!0,e.ts.createProgram(n)}async function De(e,t){let r=await tr(e,t);if(!r)throw new Error(`getTypeChecker() Could not create program for: ${t}`);let n=r.getSourceFile(t);if(!n)throw new Error(`getTypeChecker() Could not find source file: ${t}`);return{typeChecker:r.getTypeChecker(),sourceFile:n}}var ye=class{constructor(t){this.libName=t}};async function rr(e,t){let r=`https://cdn.jsdelivr.net/npm/typescript@${e.ts.version}/lib/${t}`;we.has(t)||we.set(t,fetch(r).then(n=>n.text()).then(n=>{kt.set(t,n)})),await we.get(t),we.delete(t)}var kt=new Map,we=new Map,oe=new Map,Nt=new Map;async function Ft(e,t){if(t.node.fnParams.length>0){let{sourceFile:r,typeChecker:n}=await De(e,t.cmpInfo.filePath),i=(await ze(e,t.cmpInfo.filePath,r)).find(a=>a.cmpInfo.id===t.cmpInfo.id);if(!i)throw new Error(`createComponentInputs() Could not find component ${t.cmpInfo.name} in ${t.cmpInfo.filePath}`);return de(e,n,i.node.fnParams[0])}return[]}function ve(e,t){let r=[...t.statements],n=!1;for(let o=t.statements.length-1;o>=0;o--){let i=t.statements[o];if(e.ts.isImportDeclaration(i)&&i.importClause){let a=!1,s=i.importClause.namedBindings;if(s&&e.ts.isNamedImports(s)&&s.elements){let c=[...s.elements];for(let f=c.length-1;f>=0;f--){let x=c[f];if(e.ts.isImportSpecifier(x)){let p=x.name;if(p&&e.ts.isIdentifier(p)){let u=p.text;At(e,t,u)||c.splice(f,1)}}}if(c.length===0)a=!0;else if(s.elements.length!==c.length){let f=e.ts.factory.updateImportClause(i.importClause,!1,i.importClause.name,e.ts.factory.createNamedImports(c)),x=e.ts.factory.updateImportDeclaration(i,void 0,f,i.moduleSpecifier,void 0);r[o]=x,n=!0}}else if(i.importClause.name&&e.ts.isIdentifier(i.importClause.name)){let c=i.importClause.name.text;At(e,t,c)||(a=!0)}a&&(r.splice(o,1),n=!0)}}return n?e.ts.factory.updateSourceFile(t,r):t}function At(e,t,r){let n=!1;function o(i){if(!e.ts.isImportDeclaration(i)){if(e.ts.isIdentifier(i)&&i.text===r){n=!0;return}e.ts.forEachChild(i,o)}}return e.ts.forEachChild(t,o),n}function Ee(e,t,r,n,o,i,a){let s=null,c=null,f=null,x=-1;t=b(t),r=b(r);let p=t.find(l=>l.id===e),u=r.find(l=>l.id===e);if(n)u||(s={...b(p),inputs:b(p.inputs).map(l=>(l.isRegistered=!0,l))},x=r.length,r.push(s));else if(typeof u?.nodeIndex=="number"&&u.nodeIndex>-1){if(o)x=u.nodeIndex,c=b(u),r=r.filter(l=>l.id!==e);else if(i!=null)or(u,i),x=u.nodeIndex,f=u;else if(a!=null){let l=u.inputs.find(m=>m.name===a.name);l&&(a.registerInput===!1?l.isRegistered=!1:(ir(l,a),l.isRegistered=!0),f=u,x=u.nodeIndex)}}return{addCmpToRegistry:s,removeCmpFromRegistry:c,updateRegisteredCmp:f,nodeIndex:x,components:ie(t,r)}}function ie(e,t){let r=W([...t.map(n=>(n.isRegistered=!0,n)),...e.filter(n=>!t.some(o=>o.id===n.id)).map(n=>(n.isRegistered=!1,n))]);return r.forEach(n=>{n.inputs.sort((o,i)=>o.name.toLowerCase().localeCompare(i.name.toLowerCase()))}),r}function or(e,t){P(t.name)?e.name=t.name:t.name===null&&(e.name=e.importName),P(t.description)?e.description=t.description:t.description===null&&delete e.description,P(t.image)?e.image=t.image:t.image===null&&delete e.image}function ir(e,t){P(t.type)&&(e.type=t.type),P(t.friendlyName)?e.friendlyName=t.friendlyName:t.friendlyName===null&&delete e.friendlyName,P(t.defaultValue)||fe(t.defaultValue)||Z(t.defaultValue)?e.defaultValue=t.defaultValue:t.defaultValue===null&&delete e.defaultValue,P(t.helperText)?e.helperText=t.helperText:t.helperText===null&&delete e.helperText,t.required===!0?e.required=t.required:(t.required===null||t.required===!1)&&delete e.required}async function R(e,t,r,n,o,i,a){let[s,c]=await Promise.all([vt(e),Pt(e)]),f=s.map(u=>u.cmpInfo),x=c.components,p={components:ie(f,x),registryPath:e.registryPath,registryDisplayPath:v(e,e.registryPath)};if(t!=null){let u=s.find(C=>C.cmpInfo.id===t);if(!u)throw new Error(`Component ${t} not found`);let l=c.sourceFile,m=p.components.find(C=>C.id===t),g=await Ft(e,u);re(m,g);let S=Ee(t,f,x,r,n,o,i),d=[...l.statements],h=!1;if(S.addCmpToRegistry?(d.push(wt(e,S.addCmpToRegistry)),h=!0):S.removeCmpFromRegistry?(d.splice(S.nodeIndex,1),h=!0):S.updateRegisteredCmp&&(d[S.nodeIndex]=je(e,d[S.nodeIndex],S.updateRegisteredCmp),h=!0),h&&a){l=e.ts.factory.updateSourceFile(l,d),l=I(e,l,{namedImports:["Builder"],importPath:"@builder.io/react"}),l=I(e,l,{defaultImport:"dynamic",importPath:"next/dynamic"}),l=ve(e,l),l=Ce(e,l),e.appDir&&(l=Tt(e,l));let C=E(e,l);C=Y(C),e.appDir&&(C=bt(C)),C=await e.formatCode(e.registryPath,C),await e.writeFile(e.registryPath,C)}p.components=S.components}return p}async function Lt(e){let t=await pr(e);if(await mr(e,t),e.appDir)return e.debug(`ensure builder setup for next.js app ${e.appDir}`),ar(e,e.appDir);if(e.pagesDir)return e.debug(`ensure builder setup for next.js pages ${e.pagesDir}`),cr(e,e.pagesDir)}async function ar(e,t){let r=e.join(e.componentsDir,`builder.${e.typescriptEnabled?"tsx":"jsx"}`),n=`page.${e.typescriptEnabled?"tsx":"jsx"}`,o=e.join(t,"[...page]",n);if(!await e.exists(o)){let i=await e.formatCode(o,lr(e,o,r));await e.writeFile(o,i)}if(!await e.exists(r)){let i=await e.formatCode(r,sr(e,r));await e.writeFile(r,i)}}function sr(e,t){let r=e.typescriptEnabled;return`
"use client";
import { BuilderComponent, useIsPreviewing } from "@builder.io/react"; 
import { ${r?"BuilderContent, ":""}builder } from '@builder.io/sdk';
import DefaultErrorPage from "next/error";
import ${JSON.stringify(O(e,t,e.registryPath))};
${r?`
interface BuilderPageProps { 
  content?: BuilderContent;
}`:""}

// Builder Public API Key set in .env file
builder.init(process.env.${U}${r?"!":""});

export function RenderBuilderContent({ content }${r?": BuilderPageProps":""}) { 
  // Call the useIsPreviewing hook to determine if 
  // the page is being previewed in Builder
  const isPreviewing = useIsPreviewing(); 
  // If "content" has a value or the page is being previewed in Builder,
  // render the BuilderComponent with the specified content and model props.
  if (content || isPreviewing) {
    return <BuilderComponent content={content} model="page" />;
  }
  // If the "content" is falsy and the page is 
  // not being previewed in Builder, render the 
  // DefaultErrorPage with a 404.
  return <DefaultErrorPage statusCode={404} />; 
}  
`.trimStart()}function lr(e,t,r){let n=e.typescriptEnabled,o=O(e,t,r);return`
import { builder } from "@builder.io/sdk";
import { RenderBuilderContent } from ${JSON.stringify(o)};

// Builder Public API Key set in .env file
builder.init(process.env.${U}${n?"!":""});
${n?`
interface PageProps {
  params: {
    page: string[];
  };
}`:""}

export default async function Page(props${n?": PageProps":""}) {
  const content = await builder
    // Get the page content from Builder with the specified options
    .get("page", {
      userAttributes: {
        // Use the page path specified in the URL to fetch the content
        urlPath: "/" + (props?.params?.page?.join("/") || ""),
      },
      // Set prerender to false to return JSON instead of HTML
      prerender: false,
    })
    // Convert the result to a promise
    .toPromise();

  return (
    <>
      {/* Render the Builder page */}
      <RenderBuilderContent content={content} />
    </>
  );
}
`.trimStart()}async function cr(e,t){let r=`[...page].${e.typescriptEnabled?"tsx":"jsx"}`,n=e.join(t,r);if(!await e.exists(n)){let o=await e.formatCode(n,ur(e,n));await e.writeFile(n,o)}}function ur(e,t){let r=e.typescriptEnabled;return`
import React from "react";
import { useRouter } from "next/router";
import { BuilderComponent, builder, useIsPreviewing } from "@builder.io/react";
import DefaultErrorPage from "next/error";
import Head from "next/head";${r?`
import { BuilderContent } from "@builder.io/sdk";`:""}${r?`
import { GetStaticProps } from "next";`:""}
import ${JSON.stringify(O(e,t,e.registryPath))};

builder.init(process.env.${U}${r?"!":""});

// Define a function that fetches the Builder
// content for a given page
export const getStaticProps${r?": GetStaticProps":""} = async ({ params }) => {
  // Fetch the builder content for the given page
  const page = await builder
    .get("page", {
      userAttributes: {
        urlPath: "/" + ((params?.page as string[])?.join("/") || ""),
      },
    })
    .toPromise();

  // Return the page content as props
  return {
    props: {
      page: page || null,
    },
    // Revalidate the content every 5 seconds
    revalidate: 5,
  };
};

// Define a function that generates the
// static paths for all pages in Builder
export async function getStaticPaths() {
  // Get a list of all pages in Builder
  const pages = await builder.getAll("page", {
    // We only need the URL field
    fields: "data.url",
    options: { noTargeting: true },
  });

  // Generate the static paths for all pages in Builder
  return {
    paths: pages.map((page) => String(page.data?.url)).filter(url => url !== '/'),
    fallback: 'blocking',
  };
}

// Define the Page component
export default function Page({ page }${r?": { page: BuilderContent | null }":""}) {
  const router = useRouter();
  const isPreviewing = useIsPreviewing();

  // If the page content is not available
  // and not in preview mode, show a 404 error page
  if (!page && !isPreviewing) {
    return <DefaultErrorPage statusCode={404} />;
  }

  // If the page content is available, render
  // the BuilderComponent with the page content
  return (
    <>
      <Head>
        <title>{page?.data?.title}</title>
      </Head>
      {/* Render the Builder page */}
      <BuilderComponent model="page" content={page || undefined} />
    </>
  );
}
`.trimStart()}async function pr(e){let r=e.typescriptEnabled?"tsx":"jsx",n=e.join(e.componentsDir,"Counter"),o=e.join(n,`Counter.${r}`),i=e.join(n,"styles.module.css"),{component:a,styles:s}=fr(e);if(!await e.exists(o)){let c=await e.formatCode(o,a);await e.writeFile(o,c)}return await e.exists(i)||await e.writeFile(i,s),o}function fr(e){let t=e.typescriptEnabled,r=`
"use client"
import React, { useState } from "react";
import styles from "./styles.module.css";
${t?`
interface CounterProps {
  initialCount: number;
}`:""}

function Counter({ initialCount = 99 }${t?": CounterProps":""}) {
  const [count, setCount] = useState(initialCount);

  const increment = () => {
    setCount((prevCount) => prevCount + 1);
  };

  const decrement = () => {
    setCount((prevCount) => prevCount - 1);
  };

  return (
    <div className={styles.counter}>
      <button className={styles.btn} onClick={decrement}>
        -
      </button>
      <span className={styles.count}>{count}</span>
      <button className={styles.btn} onClick={increment}>
        +
      </button>
    </div>
  );
}

export default Counter;
`.trimStart(),n=`
.counter {
  margin: 32px auto;
  display: flex;
  width: 100%;
  max-width: 190px;
}

.btn {
  width: 42px;
  font-size: 32px;
  font-weight: bold;
  background-color: #1c6bd1;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  line-height: 1.4;
}

.btn:hover {
  opacity: 0.8;
}

.count {
  flex: 1;
  font-size: 42px;
  text-align: center;
  color: black;
}
`.trimStart();return{component:r,styles:n}}async function mr(e,t){await e.exists(e.registryPath)||await e.writeFile(e.registryPath,"");let n=(await R(e,null,!1,!1,null,null,!1)).components.find(o=>o.filePath===t);n&&await R(e,n.id,!0,!1,null,null,!0)}async function Rt(e){let t=await dr(e);return{builderPageOptions:async()=>({templateContentId:"3de2f13211234071a4b19a17b4fbc5a7",pathname:"/builder-demo",title:"Builder Demo Page"}),ensureBuilderSetup:()=>Lt(t),getFrameworks:()=>e.frameworks||[],getRegistryPath:()=>t.registryPath,getRegistry:()=>R(t,null,!1,!1,null,null,!1),loadComponent:async n=>{let o=await R(t,n.cmpId,!1,!1,null,null,!1);return{...o,component:o.components.find(i=>i.id===n.cmpId)}},registerComponent:n=>R(t,n.cmpId,!0,!1,null,null,!0),setRegisteredComponentInfo:n=>R(t,n.cmpId,!1,!1,n,null,!0),setRegisteredComponentInput:n=>R(t,n.cmpId,!1,!1,null,n,!0),unregisterComponent:n=>R(t,n.cmpId,!1,!0,null,null,!0),getPublicApiKey:()=>dt(t),setPublicApiKey:n=>gt(t,n.publicApiKey),getDependencies:()=>[{name:"@builder.io/dev-tools"},{name:"@builder.io/react"},{name:"@builder.io/sdk"}],getDevRunCommand:()=>"dev"}}async function dr(e){let t=e.getRootDir(),r=e.join(t,"src"),n=await xr(e),o=await gr(e),i=`builder-registry.${o?"ts":"js"}`,a=await pe(e),s={...e,appDir:null,pagesDir:null,srcDir:null,componentsDir:"",envPath:a.envPath,registryPath:"",nextConfigPath:n,typescriptEnabled:o};if(await e.exists(r)){s.srcDir=r,s.componentsDir=e.join(r,"components");let c=e.join(r,"app");await e.exists(c)&&(s.appDir=c);let f=e.join(r,"pages");await e.exists(f)&&(s.pagesDir=f),s.registryPath=e.join(r,i)}else s.componentsDir=e.join(t,"components"),s.registryPath=e.join(t,i);if(!s.appDir){let c=e.join(t,"app");await e.exists(c)&&(s.appDir=c)}if(!s.pagesDir){let c=e.join(t,"pages");await e.exists(c)&&(s.pagesDir=c)}if(!s.appDir&&!s.pagesDir)throw new Error(`Could not find Next.js "app" or "pages" directory. Searched in "${t}".`);return s}function gr(e){let t=e.join(e.getRootDir(),"tsconfig.json");return e.exists(t)}async function xr(e){let t=e.join(e.getRootDir(),"next.config.ts");if(await e.exists(t))return t;let r=e.join(e.getRootDir(),"next.config.js");if(await e.exists(r))return r;throw new Error(`Could not find Next.js config file. Searched for "next.config.ts" and "next.config.js" in "${e.getRootDir()}".`)}async function Ot(e){let t=await ce(e,e.envPath);if(t){let r=t[Ke];if(typeof r=="string"&&r.length>0&&r!=="YOUR_API_KEY")return{publicApiKey:r,file:e.envPath}}return null}async function jt(e,t){return Sr(t),await ue(e,e.envPath,Ke,t),{publicApiKey:t,file:e.envPath}}function Sr(e){typeof process<"u"&&(process.env[Ke]=e)}var Ke="PUBLIC_BUILDER_API_KEY";function _t(e,t,r){if(r.length===0)return e;let n=e.split(`
`),o=n.findIndex(s=>s.includes(r));if(o===-1||n.some(s=>s.includes(t[0])))return e;let a=["/**",...t.map(s=>` * ${s.trim()}`)," */"];return n.splice(o,0,...a),n.join(`
`)}function Bt(e,t,r){return Be(e,t,r.variableName)?t:hr(e,t,r)}function hr(e,t,r){let n=typeof r.arrayType=="string"?e.ts.factory.createArrayTypeNode(e.ts.factory.createTypeReferenceNode(r.arrayType,void 0)):void 0,o=e.ts.factory.createArrayLiteralExpression([]),i=e.ts.factory.createVariableDeclaration(r.variableName,void 0,n,o),a=e.ts.factory.createVariableDeclarationList([i],e.ts.NodeFlags.Const),s=e.ts.factory.createModifier(e.ts.SyntaxKind.ExportKeyword),c=e.ts.factory.createVariableStatement([s],a),f=[...t.statements,c];return e.ts.factory.updateSourceFile(t,f)}async function zt(e){let t=[],r=async n=>{let o=await e.readdir(n);await Promise.all(o.map(async i=>{if(i.startsWith(".")||i==="node_modules"||i==="layout.tsx"||i==="404.tsx"||i==="router-head.tsx")return;let a=e.join(n,i);if(a===e.registryPath)return;let s=await Ue(e,a);if(s){t.push(...s);return}(await e.stat(a)).isDirectory()&&await r(a)}))};return await r(e.componentsDir),t}async function Ue(e,t){if(e.extname(t).toLowerCase()===".tsx"){let n=await e.readFile(t);if(n)return Cr(e,t,n)}return null}function Cr(e,t,r){let n=y(e,r);return Qe(e,t,n)}async function Qe(e,t,r){t=e.normalize(t);let n=[],o=$(e,r);return await Promise.all(o.map(async i=>{let a=await wr(e,t,i);a&&n.push(a)})),n}async function wr(e,t,r){if(e.ts.isVariableStatement(r.node))for(let n of r.node.declarationList.declarations){let o=Vt(e,n.initializer);if(o&&e.ts.isIdentifier(n.name)){let i=n.name.text;return{cmpInfo:{id:await A(e,t,i),displayFilePath:v(e,t),name:F(i),inputs:[],exportName:i,exportType:"named",importName:i,filePath:t},node:o}}}else if(e.ts.isCallExpression(r.node)){let n=Vt(e,r.node);if(n)return{cmpInfo:{id:await A(e,t,"default"),displayFilePath:v(e,t),name:Q(e,t),inputs:[],exportName:"default",exportType:"default",importName:X(e,t),filePath:t},node:n}}return null}function Vt(e,t){if(t&&e.ts.isCallExpression(t)&&e.ts.isIdentifier(t.expression)&&t.expression.text==="component$"&&t.arguments.length>0){let r=t.arguments[0];if(e.ts.isArrowFunction(r)||e.ts.isFunctionExpression(r))return{callExpression:t,qwikFnParams:r.parameters}}return null}async function $t(e,t){if(t.node.qwikFnParams.length>0){let{sourceFile:r,typeChecker:n}=await De(e,t.cmpInfo.filePath),i=(await Qe(e,t.cmpInfo.filePath,r)).find(a=>a.cmpInfo.id===t.cmpInfo.id);if(!i)throw new Error(`createComponentInputs() Could not find component ${t.cmpInfo.name} in ${t.cmpInfo.filePath}`);return de(e,n,i.node.qwikFnParams[0])}return[]}async function Kt(e){let t=await e.readFile(e.registryPath);return t?yr(e,t):{components:[],sourceFile:y(e,"")}}async function yr(e,t){let r=y(e,t);return Dr(e,r)}async function Dr(e,t){let r=[],n=xe(e,t,"CUSTOM_COMPONENTS");return n&&await Promise.all(n.arrayLiteralExp.elements.map(async(o,i)=>{let a=await qe(e,t,o);a&&(a.nodeIndex=i,r.push(a))})),{sourceFile:t,components:W(r)}}async function qe(e,t,r){if(!e.ts.isObjectLiteralExpression(r))return null;let n={id:"",name:"",displayFilePath:"",exportName:"",importName:"",filePath:"",inputs:[]};for(let o of r.properties){if(!e.ts.isPropertyAssignment(o)||!e.ts.isIdentifier(o.name))continue;if(D(e,o)==="component"&&e.ts.isIdentifier(o.initializer)){let a=o.initializer.text;n.name===""&&(n.name=F(a)),n.importName=a;let s=await yt(e,e.registryPath,t,a);if(!s)continue;n.filePath=s.filePath,n.displayFilePath=s.displayFilePath,n.exportType=s.exportType;let c=await Ue(e,s.filePath);if(c&&c.length>0)if(c.length===1)n.exportName=c[0].cmpInfo.exportName;else{let f=c.find(x=>x.cmpInfo.exportName===a);f&&(n.exportName=f.cmpInfo.exportName)}continue}}return n=ge(e,n,r),n.filePath&&n.exportName&&(n.id=await A(e,n.filePath,n.exportName)),n}async function q(e,t,r,n,o,i,a){let[s,c]=await Promise.all([zt(e),Kt(e)]),f=s.map(u=>u.cmpInfo),x=c.components,p={components:ie(f,x),registryPath:e.registryPath,registryDisplayPath:v(e,e.registryPath)};if(t!=null){let u=s.find(T=>T.cmpInfo.id===t);if(!u)throw new Error(`Component ${t} not found`);let l=c.sourceFile,m=p.components.find(T=>T.id===t),g=await $t(e,u);re(m,g);let S=Ee(t,f,x,r,n,o,i),{elements:d,elmIndex:h,statementIndex:C,statement:N,variableDeclaration:k}=await Er(e,l,u),w=!1;if(S.addCmpToRegistry?(d.push(vr(e,S.addCmpToRegistry)),w=!0):S.removeCmpFromRegistry?(d.splice(h,1),w=!0):S.updateRegisteredCmp&&(d[h]=ne(e,d[h],S.updateRegisteredCmp),w=!0),w&&a){let T=[...l.statements];T[C]=e.ts.factory.updateVariableStatement(N,N.modifiers,e.ts.factory.updateVariableDeclarationList(N.declarationList,[e.ts.factory.updateVariableDeclaration(k,k.name,k.exclamationToken,k.type,e.ts.factory.createArrayLiteralExpression(br(e,d)))])),l=e.ts.factory.updateSourceFile(l,T),m.exportType==="named"?l=I(e,l,{namedImports:[m.importName],importPath:O(e,e.registryPath,m.filePath)}):l=I(e,l,{defaultImport:m.importName,importPath:O(e,e.registryPath,m.filePath)}),l=I(e,l,{namedImports:["RegisteredComponent"],importPath:"@builder.io/sdk-qwik",isTypeOnly:!0}),l=Bt(e,l,{variableName:"CUSTOM_COMPONENTS",arrayType:"RegisteredComponent"}),l=ve(e,l),l=Ce(e,l);let L=E(e,l);L=Y(L),L=_t(L,Tr,"CUSTOM_COMPONENTS"),L=await e.formatCode(e.registryPath,L),await e.writeFile(e.registryPath,L)}p.components=S.components}return p}function vr(e,t){return ne(e,e.ts.factory.createObjectLiteralExpression([e.ts.factory.createPropertyAssignment("component",e.ts.factory.createIdentifier(t.importName))],!0),t)}async function Er(e,t,r){let n=xe(e,t,"CUSTOM_COMPONENTS");if(!n)throw new Error(`Exported name of the Builder registry must be "CUSTOM_COMPONENTS". Please update your Builder registry file: ${e.registryPath}`);let o=n.arrayLiteralExp.elements.filter(a=>e.ts.isObjectLiteralExpression(a)),i=-1;for(let a=0;a<o.length;a++)if((await qe(e,t,o[a]))?.id===r.cmpInfo.id){i=a;break}return{...n,elements:o,elmIndex:i}}function br(e,t){return t.sort((r,n)=>{if(e.ts.isObjectLiteralExpression(r)&&e.ts.isObjectLiteralExpression(n)){let o=Ut(e,r),i=Ut(e,n);return o.toLocaleLowerCase().localeCompare(i.toLocaleLowerCase())}return 1})}function Ut(e,t){let r=t.properties.find(n=>D(e,n)==="name");return r&&e.ts.isPropertyAssignment(r)&&e.ts.isStringLiteral(r.initializer)?r.initializer.text:"zz"}var Tr=["This array is used to integrate custom components within Builder.","https://www.builder.io/c/docs/custom-components-intro","",'These components will be found the "Custom Components"',"section of Builder's visual editor.",'You can also turn on "components only mode" to limit',"editing to only these components.","https://www.builder.io/c/docs/guides/components-only-mode"];async function Qt(e){}async function qt(e){let t=await Ir(e);return{builderPageOptions:async()=>({templateContentId:"dc70f1d979ad416d8fd357137eb9ddfb",pathname:"/",title:"Home"}),ensureBuilderSetup:()=>Qt(t),getFrameworks:()=>e.frameworks||[],getRegistryPath:()=>t.registryPath,getRegistry:()=>q(t,null,!1,!1,null,null,!1),loadComponent:async n=>{let o=await q(t,n.cmpId,!1,!1,null,null,!1);return{...o,component:o.components.find(i=>i.id===n.cmpId)}},registerComponent:n=>q(t,n.cmpId,!0,!1,null,null,!0),setRegisteredComponentInfo:n=>q(t,n.cmpId,!1,!1,n,null,!0),setRegisteredComponentInput:n=>q(t,n.cmpId,!1,!1,null,n,!0),unregisterComponent:n=>q(t,n.cmpId,!1,!0,null,null,!0),getPublicApiKey:()=>Ot(t),setPublicApiKey:n=>jt(t,n.publicApiKey),getDependencies:()=>[{name:"@builder.io/dev-tools"},{name:"@builder.io/sdk-qwik"}],getDevRunCommand:()=>"dev"}}async function Ir(e){let t=await Fe(e,e.getRootDir(),"components");if(!t)throw new Error(`Could not find components directory within project: ${e.getRootDir()}`);let r=e.join(t,"builder-registry.ts"),n=e.join(e.getRootDir(),".env");return{...e,componentsDir:t,registryPath:r,envPath:n}}var ke=vn(on(),1);async function an(e,t){let n={components:(await t.getRegistry()).components.filter(i=>i.isRegistered).map(i=>{let a={filePath:z(e.relative(e.getRootDir(),i.filePath)),name:i.name,image:i.image,description:i.description,exportName:i.exportName,inputs:b(i.inputs)};return b(a)}),version:1};e.debug("exporting registry components:",n.components.length);let o=(0,ke.compress)(n);return btoa(JSON.stringify(o))}async function sn(e,t,r){if(typeof r!="string")throw new Error("Invalid registry to import");let n=await t.getRegistry(),o=JSON.parse(atob(r)),i=(0,ke.decompress)(o),a=b(n);e.debug("importing registry components:",i.components.length);for(let s of i.components){let c=z(e.normalize(s.filePath)),f=n.components.find(p=>z(p.filePath).endsWith(c)&&p.exportName===s.exportName);if(!f){console.error(`Could not find component to register: ${s.filePath}, ${s.exportName}`);continue}e.debug(`register (${f.id})`,f.filePath),await t.registerComponent({cmpId:f.id});for(let p of s.inputs)e.debug(`set input (${f.id})`),await t.setRegisteredComponentInput({cmpId:f.id,name:p.name,type:p.type,required:p.required,defaultValue:p.defaultValue,friendlyName:p.friendlyName,helperText:p.helperText});e.debug(`set input (${f.id}) info`);let x=await t.setRegisteredComponentInfo({cmpId:f.id,name:s.name,image:s.image,description:s.description});a=b(x)}return a}var Gr={"@builder.io/qwik-city":qt,next:Rt};async function Xr(e){if(!e.ts)throw new Error("createDevTools() requires a TypeScript instance passed to the 'ts' option");if((!e.frameworks||e.frameworks.length===0)&&(e.frameworks=await G(e)),e.frameworks.length===0)throw new Error(`Supported Dev Tools framework for not found within ${e.getRootDir()}`);for(let t of e.frameworks){let r=Gr[t.name];if(r){let n=await r(e);return{...n,exportRegistry:()=>an(e,n),importRegistry:i=>sn(e,n,i)}}}throw new Error(`No framework dev tools found for ${e.getRootDir()}, ${JSON.stringify(e.frameworks,null,2)}`)}function ln(e){function t(p){if(typeof p!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(p))}function r(p,u){let l="",m=0,g=-1,S=0,d;for(let h=0;h<=p.length;++h){if(h<p.length)d=p.charCodeAt(h);else{if(d===47)break;d=47}if(d===47){if(!(g===h-1||S===1))if(g!==h-1&&S===2){if(l.length<2||m!==2||l.charCodeAt(l.length-1)!==46||l.charCodeAt(l.length-2)!==46){if(l.length>2){let C=l.lastIndexOf("/");if(C!==l.length-1){C===-1?(l="",m=0):(l=l.slice(0,C),m=l.length-1-l.lastIndexOf("/")),g=h,S=0;continue}}else if(l.length===2||l.length===1){l="",m=0,g=h,S=0;continue}}u&&(l.length>0?l+="/..":l="..",m=2)}else l.length>0?l+="/"+p.slice(g+1,h):l=p.slice(g+1,h),m=h-g-1;g=h,S=0}else d===46&&S!==-1?++S:S=-1}return l}let n=function(...u){let l="",m=!1;for(let g=u.length-1;g>=-1&&!m;g--){let S;g>=0?S=u[g]:e.cwd?S=e.cwd():S="/",t(S),S.length!==0&&(l=S+"/"+l,m=S.charCodeAt(0)===47)}return l=r(l,!m),m?l.length>0?"/"+l:"/":l.length>0?l:"."},o=function(u){if(t(u),u.length===0)return".";let l=u.charCodeAt(0)===47,m=u.charCodeAt(u.length-1)===47;return u=r(u,!l),u.length===0&&!l&&(u="."),u.length>0&&m&&(u+="/"),l?"/"+u:u};return{relative:function(u,l){if(t(u),t(l),u===l||(u=n(u),l=n(l),u===l))return"";let m=1;for(;m<u.length&&u.charCodeAt(m)===47;++m);let g=u.length,S=g-m,d=1;for(;d<l.length&&l.charCodeAt(d)===47;++d);let C=l.length-d,N=S<C?S:C,k=-1,w=0;for(;w<=N;++w){if(w===N){if(C>N){if(l.charCodeAt(d+w)===47)return l.slice(d+w+1);if(w===0)return l.slice(d+w)}else S>N&&(u.charCodeAt(m+w)===47?k=w:w===0&&(k=0));break}let L=u.charCodeAt(m+w),xn=l.charCodeAt(d+w);if(L!==xn)break;L===47&&(k=w)}let T="";for(w=m+k+1;w<=g;++w)(w===g||u.charCodeAt(w)===47)&&(T.length===0?T+="..":T+="/..");return T.length>0?T+l.slice(d+k):(d+=k,l.charCodeAt(d)===47&&++d,l.slice(d))},resolve:n,join:function(...u){if(u.length===0)return".";let l;for(let m=0;m<u.length;++m){let g=u[m];t(g),g.length>0&&(l===void 0?l=g:l+="/"+g)}return l===void 0?".":o(l)},isAbsolute:function(u){return t(u),u.length>0&&u.charCodeAt(0)===47},basename:function(u,l){if(l!==void 0&&typeof l!="string")throw new TypeError('"ext" argument must be a string');t(u);let m=0,g=-1,S=!0,d;if(l!==void 0&&l.length>0&&l.length<=u.length){if(l.length===u.length&&l===u)return"";let h=l.length-1,C=-1;for(d=u.length-1;d>=0;--d){let N=u.charCodeAt(d);if(N===47){if(!S){m=d+1;break}}else C===-1&&(S=!1,C=d+1),h>=0&&(N===l.charCodeAt(h)?--h===-1&&(g=d):(h=-1,g=C))}return m===g?g=C:g===-1&&(g=u.length),u.slice(m,g)}else{for(d=u.length-1;d>=0;--d)if(u.charCodeAt(d)===47){if(!S){m=d+1;break}}else g===-1&&(S=!1,g=d+1);return g===-1?"":u.slice(m,g)}},normalize:o,dirname:function(u){if(t(u),u.length===0)return".";let l=u.charCodeAt(0),m=l===47,g=-1,S=!0;for(let d=u.length-1;d>=1;--d)if(l=u.charCodeAt(d),l===47){if(!S){g=d;break}}else S=!1;return g===-1?m?"/":".":m&&g===1?"//":u.slice(0,g)},extname:function(u){t(u);let l=-1,m=0,g=-1,S=!0,d=0;for(let h=u.length-1;h>=0;--h){let C=u.charCodeAt(h);if(C===47){if(!S){m=h+1;break}continue}g===-1&&(S=!1,g=h+1),C===46?l===-1?l=h:d!==1&&(d=1):l!==-1&&(d=-1)}return l===-1||g===-1||d===0||d===1&&l===g-1&&l===m+1?"":u.slice(l,g)}}}async function Zr(e){let t=e.getRootDir?e.getRootDir:()=>"/",r=e.cwd?e.cwd:()=>"/",n=ln({cwd:r,...e}),o=new Map,i=p=>n.normalize(n.resolve(r(),p)),a=p=>{for(let[u]of o)if((u+"/").startsWith(p))return!0;return p===t()},s=p=>(p=i(p),o.has(p)?!0:a(p)),c=p=>{p=i(p);let u=p===t()?p:p+"/",l=u.split("/").length-1,m=[];for(let[g]of o)if(g.split("/").slice(0,l).join("/")+"/"===u){let h=g.split("/")[l];h&&!m.includes(h)&&m.push(h)}return m.sort()},f=p=>{p=i(p);let u=o.get(p);return typeof u=="string"?u:null},x=new Set;return{getRootDir:t,cwd:r,exists:async p=>s(p),existsSync:s,readdir:async p=>c(p),readdirSync:c,readFile:async p=>f(p),readFileSync:f,stat:async p=>(p=i(p),{isFile:()=>o.has(p),isDirectory:()=>!o.has(p)&&a(p)}),writeFile:async(p,u)=>{p=i(p),o.set(p,u);let l={path:p,basename:n.basename(p),dirname:n.dirname(p),extname:n.extname(p)};for(let m of x)await m(l)},hash:async p=>{if(typeof crypto<"u"){let m=new TextEncoder().encode(p),g=await crypto.subtle.digest("SHA-256",m);return Array.from(new Uint8Array(g)).map(S=>S.toString(16).padStart(2,"0")).join("")}let u=0;for(let l=0;l<p.length;l++){let m=p.charCodeAt(l);u=(u<<5)-u+m,u|=0}return Number(Math.abs(u)).toString(36)},formatCode:async(p,u)=>u,on:(p,u)=>{p==="change"&&x.add(u)},off:(p,u)=>{p==="change"&&x.delete(u)},debug:(...p)=>{console.debug("[builder-dev-tools]",...p)},openEditor:async()=>{},...n,...e}}async function cn(e,t,r){let n=y(e,r),o=$(e,n,"cjs");if(o.length!==1)throw new Error(`Expected an export from ${t}`);let i=o[0];if(!i.isDefaultExport)throw new Error(`Expected a default export from ${t}`);let a={content:r,filePath:t,fileName:e.basename(t),hasContentUpdates:!1};if(e.ts.isObjectLiteralExpression(i.node)||e.ts.isCallExpression(i.node)){let c=i.statement;if(!e.ts.isExpressionStatement(c))throw new Error("Expected an expression statement for the default export");let f=c.expression;if(!e.ts.isBinaryExpression(f))throw new Error("Expected a binary expression for the default export");let x=it(e,n);n=x.sourceFile;let p=[...n.statements],u=p.indexOf(c);return p[u]=e.ts.factory.updateExpressionStatement(c,e.ts.factory.updateBinaryExpression(f,f.left,f.operatorToken,e.ts.factory.createCallExpression(e.ts.factory.createIdentifier(x.withFnVariableName),void 0,[f.right]))),n=e.ts.factory.updateSourceFile(n,p),a.content=E(e,n),a.hasContentUpdates=!0,a}let s=i.statement;if(e.ts.isVariableStatement(s)){let c=[...s.declarationList.declarations];if(c.length!==1)throw new Error("Expected a single variable declaration");let f=c[0];if(!f.initializer)throw new Error("Expected an initializer on the declaration");let x=f.initializer;if(e.ts.isObjectLiteralExpression(x)||e.ts.isCallExpression(x)){let p=it(e,n);n=p.sourceFile;let u=[...n.statements],l=u.indexOf(s);return u[l]=e.ts.factory.updateVariableStatement(s,s.modifiers,e.ts.factory.updateVariableDeclarationList(s.declarationList,[e.ts.factory.updateVariableDeclaration(f,f.name,f.exclamationToken,f.type,e.ts.factory.createCallExpression(e.ts.factory.createIdentifier(p.withFnVariableName),void 0,[x]))])),n=e.ts.factory.updateSourceFile(n,u),a.content=E(e,n),a.hasContentUpdates=!0,a}throw new Error("Unexpected initializer on the variable statement")}if(e.ts.isArrowFunction(i.node)){let c=i.node,f=i.statement;if(!e.ts.isExpressionStatement(f))throw new Error("Expected an expression statement for the default export");let x=f.expression;if(!e.ts.isBinaryExpression(x))throw new Error("Expected a binary expression for the default export");let u=i.node.body;if(!e.ts.isBlock(u))throw new Error("Expected a block body on the next config function");let l=[...u.statements],m=l.findIndex(C=>e.ts.isReturnStatement(C));if(m===-1)throw new Error("Expected a return statement on the next config function");let g=l[m],S=it(e,n);n=S.sourceFile,l[m]=e.ts.factory.updateReturnStatement(g,e.ts.factory.createCallExpression(e.ts.factory.createIdentifier(S.withFnVariableName),void 0,[g.expression]));let d=[...n.statements],h=d.indexOf(f);return d[h]=e.ts.factory.updateExpressionStatement(f,e.ts.factory.updateBinaryExpression(x,x.left,x.operatorToken,e.ts.factory.updateArrowFunction(c,c.modifiers,c.typeParameters,c.parameters,c.type,c.equalsGreaterThanToken,e.ts.factory.updateBlock(u,l)))),n=e.ts.factory.updateSourceFile(n,d),a.content=E(e,n),a.hasContentUpdates=!0,a}throw new Error("Unexpected export type")}function it(e,t){let r=null;for(let n of t.statements)if(e.ts.isVariableStatement(n)){for(let o of n.declarationList.declarations){if(!o.initializer||!e.ts.isCallExpression(o.initializer))continue;let i=o.initializer.expression;if(!e.ts.isCallExpression(i)||!e.ts.isIdentifier(i.expression)||i.expression.text!=="require")continue;let a=i.arguments[0];if(!(!a||!e.ts.isStringLiteral(a))&&a.text==="@builder.io/dev-tools/next"&&e.ts.isIdentifier(o.name)){r=o.name.text;break}}if(r)break}return r||(r="withBuilderDevTools",t=e.ts.factory.updateSourceFile(t,[e.ts.factory.createVariableStatement(void 0,e.ts.factory.createVariableDeclarationList([e.ts.factory.createVariableDeclaration(r,void 0,void 0,e.ts.factory.createCallExpression(e.ts.factory.createCallExpression(e.ts.factory.createIdentifier("require"),void 0,[e.ts.factory.createStringLiteral("@builder.io/dev-tools/next")]),void 0,[]))],e.ts.NodeFlags.Const)),...t.statements])),{withFnVariableName:r,sourceFile:t}}async function pn(e,t,r){let n=y(e,r),o=$(e,n);if(o.length!==1)throw new Error(`Expected an export from ${t}`);let i=o[0];if(!i.isDefaultExport)throw new Error(`Expected a default export from ${t}`);let a=i.statement;if(!e.ts.isExportAssignment(a))throw new Error(`Expected an export assignment from ${t}`);let s={content:r,filePath:t,fileName:e.basename(t),hasContentUpdates:!1};if(e.ts.isCallExpression(i.node)&&e.ts.isIdentifier(i.node.expression)&&i.node.expression.text==="defineConfig"){let c=[...i.node.arguments];if(c.length===0)throw new Error("Expected an argument in defineConfig()");let f=c[0];if(e.ts.isArrowFunction(f)){let x=eo(e,f);if(!x)return s;c[0]=e.ts.factory.updateArrowFunction(f,f.modifiers,f.typeParameters,f.parameters,f.type,f.equalsGreaterThanToken,x);let p=[...n.statements],u=p.indexOf(a);return p[u]=e.ts.factory.updateExportAssignment(a,void 0,e.ts.factory.updateCallExpression(i.node,i.node.expression,i.node.typeArguments,c)),n=e.ts.factory.updateSourceFile(n,p),n=I(e,n,{namedImports:["builderDevTools"],importPath:"@builder.io/dev-tools/vite"}),s.content=E(e,n),s.hasContentUpdates=!0,s}if(e.ts.isObjectLiteralExpression(f)){let x=at(e,f);if(!x)return s;let p=[...n.statements],u=p.indexOf(a);return p[u]=e.ts.factory.updateExportAssignment(a,void 0,e.ts.factory.updateCallExpression(i.node,i.node.expression,i.node.typeArguments,[x])),n=e.ts.factory.updateSourceFile(n,p),n=I(e,n,{namedImports:["builderDevTools"],importPath:"@builder.io/dev-tools/vite"}),s.content=E(e,n),s.hasContentUpdates=!0,s}throw new Error("Unsupported argument in defineConfig()")}if(e.ts.isObjectLiteralExpression(a.expression)){let c=at(e,a.expression);if(!c)return s;let f=[...n.statements],x=f.indexOf(a);return f[x]=e.ts.factory.updateExportAssignment(a,a.modifiers,c),n=e.ts.factory.updateSourceFile(n,f),n=I(e,n,{namedImports:["builderDevTools"],importPath:"@builder.io/dev-tools/vite"}),s.content=E(e,n),s.hasContentUpdates=!0,s}throw new Error(`Unable to parse ${t}`)}function eo(e,t){let r=t.body;if(!e.ts.isBlock(r))return null;let n=[...r.statements],o=n.findIndex(s=>e.ts.isReturnStatement(s));if(o===-1){let s=e.ts.factory.createReturnStatement(e.ts.factory.createObjectLiteralExpression());n.push(s),o=n.length-1}let i=n[o];if(!i.expression||!e.ts.isObjectLiteralExpression(i.expression))return null;let a=at(e,i.expression);return a?(n[o]=e.ts.factory.updateReturnStatement(i,a),e.ts.factory.updateBlock(r,n)):null}function at(e,t){let r=[...t.properties],n=r.findIndex(i=>D(e,i)==="plugins");if(n>-1){let i=r[n];if(e.ts.isPropertyAssignment(i)&&i.initializer&&e.ts.isArrayLiteralExpression(i.initializer)){let a=un(e,i.initializer);if(a)return r[n]=e.ts.factory.updatePropertyAssignment(i,i.name,a),e.ts.factory.updateObjectLiteralExpression(t,r)}return null}let o=un(e,e.ts.factory.createArrayLiteralExpression([],!0));return o?e.ts.factory.updateObjectLiteralExpression(t,[...r,e.ts.factory.createPropertyAssignment("plugins",o)]):null}function un(e,t){return t.elements.some(n=>e.ts.isCallExpression(n)&&e.ts.isIdentifier(n.expression)?n.expression.text==="builderDevTools":!1)?null:e.ts.factory.updateArrayLiteralExpression(t,[...t.elements,e.ts.factory.createCallExpression(e.ts.factory.createIdentifier("builderDevTools"),void 0,[])])}async function fn(e,t,r){throw new Error("Webpack config updates not implemented")}var dn=[{id:"next",configFileNames:["next.config.ts","next.config.js"],ensureConfigPlugin:cn},{id:"vite",configFileNames:["vite.config.ts","vite.config.js"],ensureConfigPlugin:pn},{id:"webpack",configFileNames:["webpack.config.ts","webpack.config.js"],ensureConfigPlugin:fn}];async function gn(e){let t=e.resolve("/");for(let n of dn)for(let o of n.configFileNames){let i=e.cwd();for(let a=0;a<10;a++){let s=e.join(i,o),c=e.readFileSync(s);if(typeof c=="string")return{id:n.id,filePath:s,content:c};if(i===t)break;i=e.dirname(i)}}if((await G(e)).some(n=>n.name==="next")){let n=e.join(e.getRootDir(),"next.config.js");return await e.writeFile(n,mn),{id:"next",filePath:n,content:mn}}return null}async function to(e){let t=await gn(e);if(!t)throw new Error("Unable to find config file, such as next.config.js or vite.config.js.");let n=await dn.find(o=>o.id===t.id).ensureConfigPlugin(e,t.filePath,t.content);return n.hasContentUpdates&&(n.content=Y(n.content),n.content=await e.formatCode(n.filePath,n.content),await e.writeFile(t.filePath,n.content)),n}var mn=`
/** @type {import('next').NextConfig} */
const nextConfig = {
}
 
module.exports = nextConfig
`.trimStart();var Va="0.0.40";export{Xr as createDevTools,Zr as createDevToolsSys,G as detectFrameworks,ut as detectFrameworksFromPackageJson,to as ensureConfigPlugin,gn as findBuildToolConfig,mt as parseDotEnvContent,Va as version};
